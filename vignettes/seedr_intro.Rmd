---
title: "seedr: Hydro and Thermal Time Germination Models"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{seedr_Hydro_and_Thermal_Time_Germination_Models}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(seedr)
```

# _physiodata_, a S3 class to store germination data

The first steps in a hydrothermal analysis should be done using the _physiodata()_ function, which will crease a _physiodata_ object storing the germination data. This object will be used by other functions, and it can also be used to explore the data:

```{r}
cent <- physiodata(centaury, x = "temperature") # the x argument denotes the experimental treatment, usually water potential or temperature
```

Using _summary()_ on a _physiodata_ object will produce a table with the final germination proportions and median germination rate (1/t50) per treatment:

```{r}
summary(cent)
```

Using _plot()_ on a _physiodata_ object will produce a plot of the cumulative germination curves:

```{r fig.width = 7, fig.height = 5}
plot(cent)
```

Using _barplot()_ on a _physiodata_ object will produce a plot of the final germination proportions and the median germination rate:

```{r fig.width = 7, fig.height = 5}
barplot(cent)
```

If your data has several groups (for example, several species, populations or treatments of stratification), you can indicate the with the _groups_ argument. Also, if your dataset contains column names different from the default ones, you can also indicate that with the arguments of _physiodata_:

```{r fig.width = 7, fig.height = 5}
grass <- physiodata(grasses, x = "psi", groups = "species") # the x argument denotes the experimental treatment, usually water potential or temperature
plot(grass)
```

# Bradford's model hydrotime model

You can fit Bradford's hydrotime model to your _physiodata_ object using the function _bradford_:

```{r}
anisantha <- physiodata(subset(grasses, species == "Anisantha rubens"), x = "psi") # select only one species
b <- bradford(anisantha$proportions) # bradford() uses the $proportions element within the physiodata object
b
```

A _bradford_ object can be plotted using _plot()_:

```{r fig.width = 7, fig.height = 5}
plot(b)
```

# Garcia-Huidobro's thermal time model

You can fit Garcia-Huidobro's thermal time model to your _physiodata_ object using the function _huidobro_:

```{r}
malva <- physiodata(subset(centaury, population == "La Malva"), x = "temperature") # select only one population
h <- huidobro(malva$proportions) # huidobro() uses the $proportions element within the physiodata object
h
```

A _huidobro_ object can be plotted using _plot()_:

```{r fig.width = 7, fig.height = 5}
plot(h)
```

# The _physiotime_ function

_physiotime()_ allows to centralize the operations described in the previous sections. It creates your _physiodata_ object, divides it in the _groups_ you indicate, and fits the model named in its _method_ argument:

```{r}
m <- physiotime(centaury, x = "temperature", method = "huidobro", groups = c("species", "population"))
m
```

With _summary()_, you obtain a table of the fitted model parameters which is easy to export for further uses:

```{r}
summary(m)
```

_plot()_ will plot the fitted models:

```{r fig.width = 7, fig.height = 5}
plot(m)
```
